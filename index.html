<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Paster!!! Canned Notes">
    <meta name="theme-color" content="#667eea">
    <title>Paster!!! Canned Notes</title>
    
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlBpY2sgTGlzdCBNYW5hZ2VyIiwKICAic2hvcnRfbmFtZSI6ICJQaWNrTGlzdCIsCiAgImRlc2NyaXB0aW9uIjogIk1hbmFnZSBtdWx0aXBsZSBwaWNrIGxpc3RzIiwKICAic3RhcnRfdXJsIjogIi4iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJ0aGVtZV9jb2xvciI6ICIjNjY3ZWVhIiwKICAiaWNvbnMiOiBbeyJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxOTInIGhlaWdodD0nMTkyJz4lM0NyZWN0IHdpZHRoPScxOTInIGhlaWdodD0nMTkyJyBmaWxsPSclMjM2NjdlZWEnLz4lM0N0ZXh0IHg9JzUwJTI1JyB5PSc1MCUyNScgZm9udC1zaXplPSc4MCcgZmlsbD0nJTIzZmZmJyB0ZXh0LWFuY2hvcj0nbWlkZGxlJyBkb21pbmFudC1iYXNlbGluZT0nbWlkZGxlJz7wn5OLJTNDL3RleHQ+JTNDL3N2Zz4iLCJzaXplcyI6ICIxOTJ4MTkyIiwidHlwZSI6ICJpbWFnZS9zdmcreG1sIn0seyJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJz4lM0NyZWN0IHdpZHRoPSc1MTInIGhlaWdodD0nNTEyJyBmaWxsPSclMjM2NjdlZWEnLz4lM0N0ZXh0IHg9JzUwJTI1JyB5PSc1MCUyNScgZm9udC1zaXplPScyNDAnIGZpbGw9JyUyM2ZmZicgdGV4dC1hbmNob3I9J21pZGRsZScgZG9taW5hbnQtYmFzZWxpbmU9J21pZGRsZSc+8J+TiyUzQy90ZXh0PiUzQy9zdmc+Iiwic2l6ZXMiOiAiNTEyeDUxMiIsInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCJ9XX0=">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Crect width='180' height='180' fill='%23667eea'/%3E%3Ctext x='50%25' y='50%25' font-size='80' fill='%23fff' font-family='Arial' text-anchor='middle' dominant-baseline='middle'%3Eüìã%3C/text%3E%3C/svg%3E">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 10px 10px 80px; }
        .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); padding: 15px; }
        h1 { text-align: center; color: #333; margin-bottom: 15px; font-size: 1.5em; }
        .auto-save { text-align: center; color: #28a745; font-size: 0.85em; margin-bottom: 10px; min-height: 20px; }
        .install-prompt { background: #667eea; color: white; padding: 12px; border-radius: 8px; margin-bottom: 15px; text-align: center; display: none; }
        .install-prompt button { background: white; color: #667eea; border: none; padding: 8px 16px; border-radius: 6px; font-weight: 600; margin: 5px; }
        .add-list { background: #764ba2; color: white; border: none; padding: 14px; border-radius: 8px; font-size: 1em; width: 100%; font-weight: 600; margin-bottom: 15px; }
        .lists { display: flex; flex-direction: column; gap: 15px; margin-bottom: 15px; }
        .list { background: #f8f9fa; border-radius: 8px; padding: 15px; border: 2px solid #e9ecef; }
        .list-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; gap: 10px; }
        .title-area { display: flex; align-items: center; flex: 1; min-width: 0; }
        .reorder { display: flex; flex-direction: column; gap: 2px; margin-right: 8px; }
        .reorder button { background: #6c757d; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 0.7em; min-width: 44px; min-height: 22px; }
        h2 { color: #495057; font-size: 1.1em; flex: 1; padding: 8px; border-radius: 4px; word-break: break-word; }
        h2:active { background: #e9ecef; }
        .actions { display: flex; gap: 5px; }
        .actions button { border: none; padding: 8px 12px; border-radius: 6px; font-size: 0.9em; min-width: 44px; min-height: 44px; color: white; }
        .del-list { background: #dc3545; }
        .add-item { background: #28a745; }
        .items { border: 1px solid #ced4da; border-radius: 6px; max-height: 250px; overflow-y: auto; background: white; margin-bottom: 12px; }
        .item { padding: 12px; border-bottom: 1px solid #e9ecef; display: flex; align-items: center; gap: 8px; min-height: 50px; }
        .item:last-child { border-bottom: none; }
        .item.sel { background: #667eea; color: white; }
        .item-order { display: flex; flex-direction: column; gap: 2px; }
        .item-order button { background: #6c757d; color: white; border: none; padding: 4px; border-radius: 3px; font-size: 0.7em; min-width: 30px; min-height: 20px; }
        .item-text { flex: 1; word-break: break-word; }
        .item-btns { display: flex; gap: 5px; }
        .item-btns button { border: none; padding: 8px 10px; border-radius: 4px; font-size: 0.85em; min-width: 44px; min-height: 44px; color: white; }
        .edit { background: #17a2b8; }
        .del { background: #dc3545; }
        .select { background: #667eea; color: white; border: none; padding: 12px; border-radius: 6px; width: 100%; font-size: 1em; font-weight: 600; min-height: 48px; }
        .section { background: #f8f9fa; border-radius: 8px; padding: 15px; border: 2px solid #e9ecef; margin-bottom: 15px; }
        .section h2 { color: #495057; margin-bottom: 12px; font-size: 1.1em; padding: 0; }
        textarea { width: 100%; min-height: 150px; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; font-family: monospace; font-size: 1em; resize: vertical; margin-bottom: 12px; }
        .btns { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .btns button { padding: 12px; border: none; border-radius: 6px; font-size: 0.95em; font-weight: 600; min-height: 48px; color: white; }
        .date { background: #17a2b8; }
        .export { background: #28a745; }
        .clear { background: #dc3545; }
        .copy { background: #007bff; }
        .backup { background: #6c757d; }
        .notif { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #28a745; color: white; padding: 12px 20px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); opacity: 0; transition: opacity 0.3s; z-index: 1000; max-width: 90%; text-align: center; }
        .notif.show { opacity: 1; }
        .jump { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 100; }
        .jump button { background: #667eea; color: white; border: none; padding: 12px; border-radius: 50%; font-size: 1.2em; width: 50px; height: 50px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); }
        .sep-toggle { background: #f8f9fa; border-radius: 8px; padding: 15px; border: 2px solid #e9ecef; margin-bottom: 15px; text-align: center; }
        .sep-toggle label { color: #495057; font-weight: 600; display: block; margin-bottom: 10px; }
        .sep-btns { display: flex; gap: 10px; justify-content: center; }
        .sep-btns button { padding: 10px 20px; border: 2px solid #667eea; background: white; color: #667eea; border-radius: 6px; font-weight: 600; min-height: 44px; }
        .sep-btns button.on { background: #667eea; color: white; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 2000; padding: 20px; }
        .modal.show { display: flex; }
        .modal-box { background: white; padding: 20px; border-radius: 12px; width: 100%; max-width: 500px; max-height: 80vh; display: flex; flex-direction: column; }
        .modal-box h3 { margin-bottom: 15px; color: #333; font-size: 1.2em; flex-shrink: 0; }
        .modal-box textarea { width: 100%; min-height: 150px; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; margin-bottom: 15px; font-size: 1em; resize: vertical; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
        .modal-box input { width: 100%; padding: 12px; border: 1px solid #ced4da; border-radius: 6px; margin-bottom: 15px; font-size: 1em; }
        .modal-btns { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; flex-shrink: 0; }
        .modal-btns button { padding: 12px; border: none; border-radius: 6px; font-size: 1em; font-weight: 600; min-height: 48px; }
        .cancel { background: #6c757d; color: white; }
        .ok { background: #28a745; color: white; }
    </style>
</head>
<body>
    <div class="notif" id="notif"></div>
    <div class="modal" id="itemModal"><div class="modal-box"><h3 id="itemTitle">Add Item</h3><textarea id="itemInput" placeholder="Enter item text (you can use multiple lines)"></textarea><div class="modal-btns"><button class="cancel" onclick="closeItemModal()">Cancel</button><button class="ok" id="itemOk" onclick="saveItem()">Add</button></div></div></div>
    <div class="modal" id="listModal"><div class="modal-box"><h3>Add Paster List</h3><input id="listInput" placeholder="Enter list name"><div class="modal-btns"><button class="cancel" onclick="closeListModal()">Cancel</button><button class="ok" onclick="saveList()">Create</button></div></div></div>
    <div class="modal" id="renameModal"><div class="modal-box"><h3>Rename List</h3><input id="renameInput" placeholder="Enter new name"><div class="modal-btns"><button class="cancel" onclick="closeRenameModal()">Cancel</button><button class="ok" onclick="saveRename()">Rename</button></div></div></div>

    <div class="container">
        <h1>Paster!!! Canned Notes</h1>
        <div class="install-prompt" id="install"><p>üì± Install this app!</p><button onclick="showHow()">How</button><button onclick="hideInstall()">Dismiss</button></div>
        <div class="auto-save" id="save"></div>
        
        <div class="section"><h2>Text Editor</h2><textarea id="editor" placeholder="Selected items appear here..."></textarea><div class="btns"><button class="date" onclick="addDate()">üìÖ Date/Time</button><button class="export" onclick="exportTxt()">üíæ Export</button><button class="clear" onclick="clearTxt()">Clear</button><button class="copy" onclick="copyTxt()">Copy</button></div></div>
        
        <div class="sep-toggle"><label>Separator:</label><div class="sep-btns"><button id="spaceBtn" onclick="setSep('space')">Space</button><button id="newlineBtn" class="on" onclick="setSep('newline')">New Line</button></div></div>
        
        <div class="section"><h2>Backup & Restore</h2><div class="btns"><button class="backup" onclick="download()">üíæ Download</button><button class="backup" onclick="restore.click()">üìÅ Restore</button><input type="file" id="restore" accept=".json" style="display:none" onchange="upload(event)"></div></div>
        
        <button class="add-list" onclick="openListModal()">+ Add New Paster List</button>
        <div class="lists" id="lists"></div>
    </div>

    <div class="jump">
        <button onclick="toTop()" title="Jump to Top">‚Üë</button>
        <button onclick="toBottom()" title="Jump to Bottom">‚Üì</button>
    </div>

    <script>
const data={1:['Apple','Banana','Orange','Grape'],2:['Red','Blue','Green','Yellow'],3:['Small','Medium','Large','XLarge'],4:['Morning','Afternoon','Evening','Night']};
const names={1:'List 1',2:'List 2',3:'List 3',4:'List 4'};
let sel={},curList=null,curIdx=null,curRen=null,order=[1,2,3,4],nextId=5,saveTimer=null,prompt=null,sep='newline';

function setSep(type){sep=type;document.getElementById('spaceBtn').classList.toggle('on',type==='space');document.getElementById('newlineBtn').classList.toggle('on',type==='newline');}
function toTop(){window.scrollTo({top:0,behavior:'smooth'});}
function toBottom(){window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});}

window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();prompt=e;checkInstall();});
function checkInstall(){if(!(window.matchMedia('(display-mode: standalone)').matches||window.navigator.standalone)&&!localStorage.getItem('noInstall'))document.getElementById('install').style.display='block';}
function showHow(){if(/iPad|iPhone|iPod/.test(navigator.userAgent))alert('Install:\n1. Tap Share (‚ñ°‚Üë)\n2. Tap "Add to Home Screen"\n3. Tap "Add"');else if(prompt){prompt.prompt();prompt.userChoice.then(r=>{if(r.outcome==='accepted')hideInstall();prompt=null;});}else alert('Use browser menu to install');}
function hideInstall(){document.getElementById('install').style.display='none';localStorage.setItem('noInstall','1');}

if('serviceWorker'in navigator){const sw=`const C='pl-v1';self.addEventListener('install',e=>self.skipWaiting());self.addEventListener('activate',e=>e.waitUntil(self.clients.claim()));self.addEventListener('fetch',e=>e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request))));`;navigator.serviceWorker.register(URL.createObjectURL(new Blob([sw],{type:'application/javascript'}))).catch(e=>console.log(e));}
window.addEventListener('load',checkInstall);

function save(){clearTimeout(saveTimer);saveTimer=setTimeout(()=>{try{localStorage.setItem('data',JSON.stringify({data,names,order,nextId,time:new Date().toISOString()}));const s=document.getElementById('save');s.textContent='‚úì Saved';setTimeout(()=>s.textContent='',2000);}catch(e){console.error(e);}},500);}

function load(){try{const s=localStorage.getItem('data');if(s){const d=JSON.parse(s);Object.assign(data,d.data);Object.assign(names,d.names);order=d.order||Object.keys(d.data).map(k=>parseInt(k));nextId=d.nextId||5;for(const id in data)sel[id]=null;}}catch(e){console.error(e);}}

function render(){const c=document.getElementById('lists');c.innerHTML='';for(const id of order)if(data[id])makeList(id);}

function makeList(n){const c=document.getElementById('lists'),d=document.createElement('div'),h=document.createElement('div'),t=document.createElement('div'),r=document.createElement('div'),u=document.createElement('button'),dn=document.createElement('button'),h2=document.createElement('h2'),a=document.createElement('div'),i=document.createElement('div'),s=document.createElement('button');d.className='list';h.className='list-header';t.className='title-area';r.className='reorder';u.textContent='‚ñ≤';u.onclick=()=>up(n);dn.textContent='‚ñº';dn.onclick=()=>down(n);r.appendChild(u);r.appendChild(dn);h2.textContent=names[n]||`List ${n}`;h2.onclick=()=>openRenameModal(n);t.appendChild(r);t.appendChild(h2);a.className='actions';if(Object.keys(data).length>1){const del=document.createElement('button');del.className='del-list';del.textContent='üóë';del.onclick=()=>delList(n);a.appendChild(del);}const add=document.createElement('button');add.className='add-item';add.textContent='+';add.onclick=()=>openItemModal(n);a.appendChild(add);h.appendChild(t);h.appendChild(a);i.className='items';i.id=`items${n}`;s.className='select';s.textContent='Select';s.onclick=()=>pick(n);d.appendChild(h);d.appendChild(i);d.appendChild(s);c.appendChild(d);items(n);}

function up(n){const i=order.indexOf(parseInt(n));if(i>0){[order[i],order[i-1]]=[order[i-1],order[i]];render();save();}}
function down(n){const i=order.indexOf(parseInt(n));if(i<order.length-1){[order[i],order[i+1]]=[order[i+1],order[i]];render();save();}}

function items(n){const c=document.getElementById(`items${n}`);if(!c)return;c.innerHTML='';if(data[n].length===0){const e=document.createElement('div');e.style.padding='20px';e.style.textAlign='center';e.style.color='#6c757d';e.textContent='No items';c.appendChild(e);return;}data[n].forEach((v,i)=>{const d=document.createElement('div'),r=document.createElement('div'),u=document.createElement('button'),dn=document.createElement('button'),t=document.createElement('span'),a=document.createElement('div'),e=document.createElement('button'),del=document.createElement('button');d.className='item';if(sel[n]===v)d.classList.add('sel');r.className='item-order';u.textContent='‚ñ≤';u.onclick=ev=>{ev.stopPropagation();upItem(n,i);};dn.textContent='‚ñº';dn.onclick=ev=>{ev.stopPropagation();downItem(n,i);};r.appendChild(u);r.appendChild(dn);t.className='item-text';t.textContent=v;t.onclick=()=>choose(n,v);a.className='item-btns';e.className='edit';e.textContent='‚úèÔ∏è';e.onclick=ev=>{ev.stopPropagation();edit(n,i);};del.className='del';del.textContent='√ó';del.onclick=ev=>{ev.stopPropagation();delItem(n,i);};a.appendChild(e);a.appendChild(del);d.appendChild(r);d.appendChild(t);d.appendChild(a);c.appendChild(d);});}

function upItem(n,i){if(i>0){[data[n][i],data[n][i-1]]=[data[n][i-1],data[n][i]];items(n);save();}}
function downItem(n,i){if(i<data[n].length-1){[data[n][i],data[n][i+1]]=[data[n][i+1],data[n][i]];items(n);save();}}
function choose(n,v){sel[n]=v;items(n);}
function pick(n){const v=sel[n];if(v){const e=document.getElementById('editor'),s=sep==='space'?' ':'\n',t=e.value?e.value+s+v:v;e.value=t;clip(v);notify(`"${v}" copied!`);}}
function delItem(n,i){if(confirm('Delete?')){data[n].splice(i,1);if(sel[n]===data[n][i])sel[n]=null;items(n);save();}}
function delList(n){if(confirm(`Delete "${names[n]}"?`)){delete data[n];delete names[n];delete sel[n];const i=order.indexOf(parseInt(n));if(i>-1)order.splice(i,1);render();save();notify('Deleted!');}}

function clearTxt(){document.getElementById('editor').value='';}
function addDate(){const now=new Date(),m=String(now.getMonth()+1).padStart(2,'0'),d=String(now.getDate()).padStart(2,'0'),y=now.getFullYear();let h=now.getHours();const min=String(now.getMinutes()).padStart(2,'0'),ap=h>=12?'PM':'AM';h=h%12||12;const dt=`${m}/${d}/${y} ${String(h).padStart(2,'0')}:${min} ${ap} `,e=document.getElementById('editor'),p=e.selectionStart;e.value=e.value.substring(0,p)+dt+e.value.substring(e.selectionEnd);e.setSelectionRange(p+dt.length,p+dt.length);e.focus();notify('Date added!');}
function copyTxt(){clip(document.getElementById('editor').value);notify('Copied!');}
function exportTxt(){const t=document.getElementById('editor').value;if(!t.trim()){alert('Empty');return;}const now=new Date(),fn=`export_${now.getFullYear()}_${String(now.getMonth()+1).padStart(2,'0')}_${String(now.getDate()).padStart(2,'0')}.txt`,l=document.createElement('a');l.href=URL.createObjectURL(new Blob([t],{type:'text/plain'}));l.download=fn;l.click();notify(`Exported!`);}
function clip(t){if(navigator.clipboard)navigator.clipboard.writeText(t).catch(e=>console.error(e));}
function notify(m){const n=document.getElementById('notif');n.textContent=m;n.classList.add('show');setTimeout(()=>n.classList.remove('show'),2000);}

function openItemModal(n){curList=n;curIdx=null;document.getElementById('itemTitle').textContent='Add Item';document.getElementById('itemOk').textContent='Add';document.getElementById('itemInput').value='';document.getElementById('itemModal').classList.add('show');setTimeout(()=>document.getElementById('itemInput').focus(),100);}
function edit(n,i){curList=n;curIdx=i;document.getElementById('itemTitle').textContent='Edit Item';document.getElementById('itemOk').textContent='Save';document.getElementById('itemInput').value=data[n][i];document.getElementById('itemModal').classList.add('show');setTimeout(()=>{const inp=document.getElementById('itemInput');inp.focus();inp.select();},100);}
function closeItemModal(){document.getElementById('itemModal').classList.remove('show');curList=null;curIdx=null;}
function saveItem(){const v=document.getElementById('itemInput').value.trim();if(v&&curList){if(curIdx!==null){const old=data[curList][curIdx];data[curList][curIdx]=v;if(sel[curList]===old)sel[curList]=v;const e=document.getElementById('editor'),s=sep==='space'?' ':'\n',t=e.value?e.value+s+v:v;e.value=t;clip(v);items(curList);notify('Updated & copied!');}else{data[curList].push(v);items(curList);notify(`"${v}" added!`);}save();closeItemModal();}}

document.getElementById('itemInput').addEventListener('keypress',e=>{if(e.key==='Enter')saveItem();});
document.getElementById('itemModal').addEventListener('click',e=>{if(e.target.id==='itemModal')closeItemModal();});

function openListModal(){document.getElementById('listInput').value='';document.getElementById('listModal').classList.add('show');setTimeout(()=>document.getElementById('listInput').focus(),100);}
function closeListModal(){document.getElementById('listModal').classList.remove('show');}
function saveList(){const v=document.getElementById('listInput').value.trim();if(v){const id=nextId++;data[id]=[];names[id]=v;sel[id]=null;order.push(id);makeList(id);save();notify(`"${v}" created!`);closeListModal();}}

document.getElementById('listModal').addEventListener('click',e=>{if(e.target.id==='listModal')closeListModal();});
document.getElementById('listInput').addEventListener('keypress',e=>{if(e.key==='Enter')saveList();});

function openRenameModal(n){curRen=n;document.getElementById('renameInput').value=names[n]||`List ${n}`;document.getElementById('renameModal').classList.add('show');setTimeout(()=>{const inp=document.getElementById('renameInput');inp.focus();inp.select();},100);}
function closeRenameModal(){document.getElementById('renameModal').classList.remove('show');curRen=null;}
function saveRename(){const v=document.getElementById('renameInput').value.trim();if(v&&curRen){names[curRen]=v;render();save();notify('Renamed!');closeRenameModal();}}

document.getElementById('renameModal').addEventListener('click',e=>{if(e.target.id==='renameModal')closeRenameModal();});
document.getElementById('renameInput').addEventListener('keypress',e=>{if(e.key==='Enter')saveRename();});

function download(){const b={version:'1.0',timestamp:new Date().toISOString(),data,names,order,nextId},l=document.createElement('a');l.href=URL.createObjectURL(new Blob([JSON.stringify(b,null,2)],{type:'application/json'}));l.download=`picklist-${new Date().toISOString().split('T')[0]}.json`;l.click();notify('Downloaded!');}
function upload(ev){const f=ev.target.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{try{const b=JSON.parse(e.target.result);if(!b.data||typeof b.data!=='object')throw new Error('Invalid');Object.keys(data).forEach(k=>delete data[k]);Object.keys(names).forEach(k=>delete names[k]);Object.keys(sel).forEach(k=>delete sel[k]);Object.assign(data,b.data);Object.assign(names,b.names||{});order=b.order||Object.keys(data).map(k=>parseInt(k));nextId=b.nextId||5;for(const id in data)sel[id]=null;render();save();notify('Restored!');}catch(err){alert('Error: '+err.message);}};r.readAsText(f);ev.target.value='';}

load();
render();
    </script>
</body>
</html>
